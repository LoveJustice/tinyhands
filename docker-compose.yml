data:
  image: silintl/data-volume:latest
  container_name: data
  volumes:
      - ./application:/data

db:
  image: postgres
  container_name: db
  ports:
    - "5432"

web:
  build: .
  command: bash bin/run.sh
  expose:
    - "9001"
  volumes_from:
    - data
  links:
    - db
  environment:
      DJANGO_SETTINGS_MODULE: dreamsuite.settings.local
      DB_NAME: postgres
      DB_USER: postgres
      DB_PASSWORD: password
      DB_HOST: db
      DB_PORT: 5432

# nginx:
#   build: ./Dockerfile-nginx
#   ports:
#     - "80:80"
#     - "443:443"
#   links:
#     - web:web

# cron:
#    image: doorman-api
#    container_name: cron
#    volumes_from:
#        - data
#    command: /data/bin/run-cron.sh

run-unit-tests:
  build: .
  volumes_from:
    - data
  links:
    - db
  environment:
      DJANGO_SETTINGS_MODULE: dreamsuite.settings.local
      DB_NAME: postgres
      DB_USER: postgres
      DB_PASSWORD: password
      DB_HOST: db
      DB_PORT: 5432

# https://hub.docker.com/r/peterrosell/karma-protractor/
# run-karma-tests:
#   image: peterrosell/karma-protractor
#   command: karma start
