# -*- coding: utf-8 -*-
# Generated by Django 1.11.29 on 2021-11-09 17:19
from __future__ import unicode_literals

import django.contrib.postgres.fields.jsonb
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('dataentry', '0205_irfcommon_pv_stopped_on_own'),
    ]

    operations = [
        migrations.AddField(
            model_name='personmatch',
            name='match_results',
            field=django.contrib.postgres.fields.jsonb.JSONField(null=True),
        ),
        migrations.CreateModel(
            name='PendingMatchWithCountry',
            fields=[
                ('the_key', models.CharField(max_length=100, primary_key=True, serialize=False)),
            ],
            options={
                'db_table': 'pendingmatchwithcountry',
                'managed': False,
            },
        ),
        migrations.RunSQL("update dataentry_personmatch as dp "\
                          "set match_results = ("\
                            "select match_results "\
                            "from  dataentry_matchhistory dm "\
                            "where match_results is not null and dm.master1_id = dp.master1_id and dm.master2_id = dp.master2_id)"\
                          "where dp.match_results is null"),
    ]
