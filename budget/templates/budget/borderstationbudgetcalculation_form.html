{% extends 'base.html' %}
{% load widget_tweaks %}
{% load bootstrap %}
{% load humanize %}
{% load unslugify %}




{% block title %}Budget Calculation{% endblock %}

{% block tab_block %}
    {% block content %}
        <!--<script type="text/javascript" src="http://knockoutjs.com/downloads/knockout-3.2.0.js"></script>-->
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular-cookies.js"></script>

     <h1 style="font-size: 25px; text-align: center">Tiny Hands Nepal - Border Monitoring Station Budget Calculation Form</h1>

     <form id="budget-calc-form" method="post">
        {% csrf_token %}
        <!-- First Table Thing -->

        <div class="form-page" ng-app="BudgetCalculation" ng-controller="MainCtrl as main">
            <div class="row">
                <div class="col-md-4">
                </div>

                <div class="col-md-2">
                </div>

                <div class="col-md-4 col-md-offset-7">
                    <table class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>   </th>
                                <th class="text-center">INT</th>
                                <th class="text-center">$/INT</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Last Month</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>Last 3 Months</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td>All Time</td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td># of Staff</td>
                                <td colspan="2"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- End First Table Thingy -->

            <!-- Shelter -->
            <div class="row" >
                <div class="col-md-6">
                    <h2 class="background"><span>Staff Salaries</span></h2>

                    {{ staff_formset.management_form }}

                    {% for staff_form in staff_formset %}

                        <div class="row">
                            <div class="col-lg-4">
                                <h3>
                                    {{ staff_form.instance.first_name }}
                                    {{ staff_form.instance.last_name }}
                                </h3>
                            </div>
                            <div class="col-lg-7">
                                    {{ staff_form|bootstrap }}
                            </div>
                        </div>

                    {% endfor %}

                </div>
                <div class="col-md-6">
                    <h2 class="background"><span>Shelter</span></h2>
                    <div class="row" >
                        <div class="col-lg-2 input-with-text calc-form-input-no-width" style="width: 100px; padding: 0">
                            <input class="form-control" type="number" id="shelter_rent" ng-model="main.form.shelter_rent"/>
                            <small>Rent</small>
                        </div>
                        <div class="col-lg-1 form-symbol" style="padding: 0">
                            <h4 style="text-align: center">+</h4>
                        </div>
                        <div class="col-lg-2 input-with-text calc-form-input-no-width" style="width: 100px; padding: 0">
                            <input class="form-control" type="number" id="shelter_water" ng-model="main.form.shelter_water"/>
                            <small>Water</small>
                        </div>
                        <div class="col-lg-1 form-symbol" style="padding: 0">
                            <h4 style="text-align: center">+</h4>
                        </div>
                        <div class="col-lg-2 input-with-text calc-form-input-no-width" style="width: 100px; padding: 0">
                            <input class="form-control" type="number" id="shelter_electricity" ng-model="main.form.shelter_electricity"/>
                            <small>Electricity</small>
                        </div>
                        <div class="col-lg-1 form-symbol" style="padding: 0">
                            <h4 style="text-align: center">=</h4>
                        </div>
                        <div class="col-lg-1 pull-right input-group" style="width: 100px; text-align: center; padding: 0">
                            <div class="input-group-addon">$</div>
                            <input style="width: 100px" class="form-control text-center" ng-value="main.utilTotal()" disabled="disabled"/>
                        </div>
                    </div>
                    <div class="row" style="margin-top: 30px; text-align: center">
                        <div class="col-lg-2" style="margin-top: 5px; width: 50px">
                            <input class="form-control" type="checkbox" id="shelterStartupBool" ng-model="main.form.shelter_shelter_startup"/>
                        </div>
                        <div class="col-lg-2 input-with-text" style="width: 100px; padding: 0">
                            <input class="form-control" type="number" id="shelter_startup_amount" ng-model="main.form.shelter_shelter_startup_amount"/>
                            <small>Shelter Startup</small>
                        </div>
                        <div class="col-lg-2" style="margin-top: 5px; width: 50px">
                            <input class="form-control" type="checkbox" id="sheltert_two_bool" ng-model="main.form.shelter_shelter_two"/>
                        </div>
                        <div class="col-lg-2 input-with-text" style="width: 100px; padding: 0">
                            <input class="form-control" type="number" id="shelter_two_amount" ng-model="main.form.shelter_shelter_two_amount"/>
                            <small>Shelter 2</small>
                        </div>
                        <div class="col-lg-1" style="padding: 0">
                            <h4 style="text-align: center">=</h4>
                        </div>
                        <div class="col-lg-1 pull-right input-group" style="width: 100px; text-align: center; padding: 0">
                            <div class="input-group-addon">$</div>
                            <input style="width: 100px" class="form-control text-center" ng-value="main.shelterCheckboxTotal()" disabled="disabled"/>
                        </div>
                    </div>

                    <div class="row center" style="margin-top: 20px; padding-right: 200px; padding-left: 200px; text-align: center">
                        <label>Shelter Total</label>
                        <input style="width: 100px" class="form-control text-center" ng-value="main.shelterTotal()" disabled="disabled"/>
                    </div>
                </div>
                <!-- End Shelter -->

                <!-- Food & Gas -->
                <div class="col-lg-6 col-lg-offset-6">
                    <h2 class="background"><span>Food & Gas</span></h2>
                    <div class="row">
                        <div class="col-lg-2 text-center">
                            <strong>Intercepted Girls</strong>
                        </div>
                        <div class="col-lg-1 form-symbol">
                            <h4 style="text-align: center">=</h4>
                        </div>
                        <div class="col-lg-2 calc-form-input">
                            <input class="form-control" type="number" id="food_gas_multiplier_before" ng-model="main.form.food_and_gas_number_of_intercepted_girls_multiplier_before"/>
                        </div>
                        <div class="col-lg-1 form-symbol">
                            <h4 style="text-align: center">*</h4>
                        </div>
                        <div class="col-lg-2 calc-form-input input-with-text">
                            <input class="form-control" type="number" id="food_gas_number_of_girls" ng-model="main.form.food_and_gas_number_of_intercepted_girls"/>
                            <small># of Girls</small>
                        </div>
                         <div class="col-lg-1 form-symbol">
                            <h4 style="text-align: center">*</h4>
                        </div>
                        <div class="col-lg-2 calc-form-input">
                            <input class="form-control" type="number" id="food_gas_multiplier_after" ng-model="main.form.food_and_gas_number_of_intercepted_girls_multiplier_after"/>
                        </div>
                        <div class="col-lg-1 form-symbol">
                            <h4 style="text-align: center">=</h4>
                        </div>
                        <div class="col-lg-2 pull-right input-group" style="padding: 0">
                            <div class="input-group-addon">$</div>
                            <input style="width: 100px" class="form-control text-center" ng-value="main.foodGasInterceptedGirls()" disabled="disabled"/>
                        </div>
                    </div>

                    <div class="row" style="margin-top: 20px">
                        <div class="col-lg-2 text-center">
                            <strong>Limbo Girls</strong>
                        </div>
                        <div class="col-lg-1 form-symbol">
                            <h4 style="text-align: center">=</h4>
                        </div>
                        <div class="col-lg-2 calc-form-input">
                            <input class="form-control" type="number" id="limbo_multiplier" ng-model="main.form.food_and_gas_limbo_girls_multiplier"/>
                        </div>
                        <div class="col-lg-1 form-symbol">
                            <h4 style="text-align: center">*</h4>
                        </div>
                        <div class="col-lg-2 calc-form-input input-with-text">
                            <input class="form-control" type="number" id="limbo_number_of_girls" ng-model="main.form.food_and_gas_number_of_limbo_girls"/>
                            <small># of Girls</small>
                        </div>
                        <div class="col-lg-1 form-symbol">
                            <h4 style="text-align: center">*</h4>
                        </div>
                        <div class="col-lg-2 calc-form-input input-with-text">
                            <input class="form-control" type="number" id="limbo_number_of_days" ng-model="main.form.food_and_gas_number_of_days"/>
                            <small># of Days</small>
                        </div>
                        <div class="col-lg-1 form-symbol">
                            <h4 style="text-align: center">=</h4>
                        </div>
                        <div class="col-lg-2 pull-right input-group" style="padding: 0">
                            <div class="input-group-addon">$</div>
                            <input style="width: 100px" class="form-control text-center" ng-value="main.foodGasLimboGirls()" disabled="disabled"/>
                        </div>
                    </div>

                    <div class="row center" style="margin-top: 20px; padding-right: 200px; padding-left: 200px; text-align: center">
                        <label>Total Food</label>
                        <input style="width: 100px" class="form-control text-center" ng-value="main.foodTotal()" disabled="disabled"/>
                    </div>
                 </div>
            </div>
            <!-- End Food & Gas -->

            <!-- Communication -->
           <div class="row">
               <div class="col-md-6">
                   <h2 class="background"><span>Communication</span></h2>
                   <div class="row">
                       <div class="col-md-6 form-inline">
                           <span style="padding-right: 10px"></span>
                           <input class="form-control" type="checkbox" id="comm_chair_bool" ng-model="main.form.communication_chair"/>
                           <input class="form-control" type="number" id="comm_chair_amount" ng-model="main.form.communication_chair_amount"/>
                           <span style="padding-left: 10px"><small>for chair</small></span>
                       </div>
                       <div class="col-md-6 form-inline">
                           <span style="padding-right: 10px"></span>
                           <input class="form-control" type="checkbox" id="comm_manager_bool" ng-model="main.form.communication_manager"/>
                           <input class="form-control" type="number" id="comm_manager_amount" ng-model="main.form.communication_manager_amount"/>
                           <span style="padding-left: 10px;"><small>for manager</small></span>
                       </div>
                   </div>
                   <div class="row" style="margin-top: 20px">
                       <div class="col-lg-5 calc-form-input-no-width input-with-text" style="width: 200px">
                           <input class="form-control" type="number" id="comm_number_of_staff_wt" ng-model="main.form.communication_number_of_staff_with_walkie_talkies"/>
                           <small># of staff with walkie-talkies</small>
                       </div>
                       <div class="col-lg-1 form-symbol" style="padding: 0; margin: 0">
                           <h4 style="text-align: center">*</h4>
                       </div>
                       <div class="col-lg-3 calc-form-input-no-width">
                           <input class="form-control" type="number" id="comm_number_of_staff_wt_multiplier" ng-model="main.form.communication_number_of_staff_with_walkie_talkies_multiplier"/>
                       </div>
                       <div class="col-lg-1 form-symbol" style="padding: 0; margin: 0">
                           <h4 style="text-align: center">=</h4>
                       </div>
                       <div class="col-lg-2 calc-form-input-no-width pull-right input-group">
                           <div class="input-group-addon">$</div>
                           <input style="width: 100px" class="form-control text-center" ng-value="main.commNumberOfStaffTotal()" disabled="disabled"/>
                       </div>
                   </div>

                   <div class="row" style="margin-top: 20px;">
                       <div class="col-lg-5 calc-form-input-no-width input-with-text" style="width: 200px">
                           <input class="form-control" type="number" id="comm_each_staff_wt" ng-model="main.form.communication_each_staff"/>
                           <small>Each Staff</small>
                       </div>
                       <div class="col-lg-1 form-symbol" style="padding: 0; margin: 0">
                           <h4 style="text-align: center">*</h4>
                       </div>
                       <div class="col-lg-3 calc-form-input-no-width">
                           <input class="form-control" type="number" id="comm_each_staff_wt_multiplier" ng-model="main.form.communication_each_staff_multiplier"/>
                       </div>
                       <div class="col-lg-1 form-symbol" style="padding: 0; margin: 0">
                           <h4 style="text-align: center">=</h4>
                       </div>
                       <div class="col-lg-2 calc-form-input-no-width pull-right input-group">
                           <div class="input-group-addon">$</div>
                           <input style="width: 100px" class="form-control text-center" ng-value="main.commEachStaffTotal()" disabled="disabled"/>
                       </div>
                   </div>
                   <div class="row center" style="margin-top: 20px; padding-right: 200px; padding-left: 200px; text-align: center">
                       <label>Total Communcation</label>
                       <input style="width: 100px" class="form-control text-center" ng-value="main.commTotal()" disabled="disabled"/>
                   </div>

               </div>
               <!-- End Communication -->

                <!-- Awareness -->
                <div class="col-lg-6">
                    <h2 class="background"><span>Awareness</span></h2>
                    <div class="row">
                        <div class="col-lg-4 col-lg-offset-2">
                            <input class="form-control" type="checkbox" id="awareness_contact_cards_bool" ng-model="main.form.awareness_contact_cards"/>
                        </div>
                        <div class="col-lg-4">

                            <input class="form-control" type="number" id="awareness_contact_cards_amount" ng-model="main.form.awareness_contact_cards_amount"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4 col-lg-offset-2">
                            <input class="form-control" type="checkbox" id="awareness_awareness_party_bool" ng-model="main.form.awareness_awareness_party_boolean"/>
                        </div>
                        <div class="col-lg-4">
                            <input class="form-control" type="number" id="awareness_awareness_party_amount" ng-model="main.form.awareness_awareness_party"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4 col-lg-offset-2">
                            <input class="form-control" type="checkbox" id="awareness_sign_boards_bool" ng-model="main.form.awareness_sign_boards_boolean"/>
                        </div>
                        <div class="col-lg-4">
                            <input class="form-control" type="number" id="awareness_sign_boards_amount" ng-model="main.form.awareness_sign_boards"/>
                        </div>
                    </div>

                    <hr>
                    <div class="row">
                        {{ awareness_items_formset.management_form }}
                        {% for item_form in awareness_items_formset %}
                            <div id='{{item_form.prefix}}'>
                                {% include "budget/other_item_cost.html" with form=item_form %}
                            </div>
                        {% endfor %}
                        <script type="text/javascript">
                            /* Allows for the creation of more or less staff/committee members */
                                $(function() {
                                    {% for formset in awareness_items_formset %}
                                    $('div#{{ formset.prefix }}').formset({
                                       prefix: '{{ formset.prefix }}',
                                       formCssClass: 'awareness-formset{{ forloop.counter }}',
                                       addText: '+ Add Another Item',
                                       deleteText: 'Remove Item',
                                       addCssClass: 'add-awareness btn btn-success changeaddbtn col-lg-offset-4',
                                       deleteCssClass: 'delete-awareness repositionremovebtn btn btn-danger',
                                    });
                                    {% endfor %}
                                })
                        </script>
                    </div>

                    <div class="row center" style="margin-top: 20px; padding-right: 200px; padding-left: 200px; text-align: center">
                        <label>Total Awareness</label>
                        <input style="width: 100px" class="form-control text-center" ng-value="main.awarenessTotal()" disabled="disabled"/>
                    </div>
                </div>
            </div>
            <!-- End Awareness -->

            <!-- Travel -->
           <div class="row">
               <div class="col-md-6">
                   <h2 class="background"><span>Travel</span></h2>

                   <div class="row">
                       <div class="col-md-6 form-inline">
                           <span style="padding-right: 10px"><input class="form-control" type="checkbox" id="travel_chair_with_bike_bool" ng-model="main.form.travel_chair_with_bike"/></span>
                           <input class="form-control" type="number" id="travel_chair_with_bike_amount" ng-model="main.form.travel_chair_with_bike_amount"/>
                           <span style="padding-left: 10px"><small>for chair</small></span>
                       </div>
                       <div class="col-md-6 form-inline">
                           <span style="padding-right: 10px"><input class="form-control" type="checkbox" id="travel_manager_with_bike_bool" ng-model="main.form.travel_manager_with_bike"/></span>
                           <input class="form-control" type="number" id="travel_manager_with_bike_amount" ng-model="main.form.travel_manager_with_bike_amount"/>
                           <span style="padding-left: 10px;"><small>for manager</small></span>
                       </div>
                   </div>

                   <div class="row" style="margin-top: 20px; padding-left: 15px">
                       <div class="col-lg-5 calc-form-input-no-width input-with-text" style="width: 150px">
                           <input class="form-control" type="number" id="travel_number_of_staff_using_bikes" ng-model="main.form.travel_number_of_staff_using_bikes"/>
                           <small># of staff using bikes</small>
                       </div>
                       <div class="col-lg-1 form-symbol" style="padding: 0; margin: 0">
                           <h4 style="text-align: center">*</h4>
                       </div>
                       <div class="col-lg-3 calc-form-input-no-width">
                           <input class="form-control" type="number" id="travel_number_of_staff_using_bikes_multiplier" ng-model="main.form.travel_number_of_staff_using_bikes_multiplier"/>
                       </div>
                       <div class="col-lg-1 form-symbol" style="padding: 0; margin: 0">
                           <h4 style="text-align: center">=</h4>
                       </div>
                       <div class="col-lg-2 pull-right input-group" style="padding: 0">
                           <div class="input-group-addon">$</div>
                           <input style="width: 100px" class="form-control text-center" ng-value="main.travelNumberOfStaffUsingBikesTotal()" disabled="disabled"/>
                       </div>
                   </div>
                   <div class="row form-inline" style="margin-top: 30px">
                       <div class="col-lg-11">
                           <span><strong>Last month's expense for sending girls home: </strong></span>
                           <input class="form-control" type="number" id="travel_sending_girls_home_expense" ng-model="main.form.travel_last_months_expense_for_sending_girls_home"/>
                       </div>
                       <div class="col-lg-1 form-symbol">
                           <h4 style="text-align: center">=</h4>
                       </div>
                   </div>


                   <div class="row" style="margin-top: 30px; padding-left: 15px">
                       <div class="col-lg-2">
                           <input class="form-control" type="checkbox" id="travel_motorbike_bool" ng-model="main.form.travel_motorbike"/>
                       </div>
                       <div class="col-lg-3 calc-form-input-no-width input-with-text">
                           <input class="form-control" type="number" id="travel_motorbike_amount" ng-model="main.form.travel_motorbike_amount"/>
                           <small>Motorbike</small>
                       </div>
                       <div class="col-lg-1 form-symbol">
                           <h4 style="text-align: center">+</h4>
                       </div>
                       <div class="col-lg-3 calc-form-input-no-width input-with-text">
                           <input class="form-control" type="number" id="travel_other" ng-model="main.form.travel_plus_other"/>
                           <small>Other</small>
                       </div>
                       <div class="col-lg-1 form-symbol">
                           <h4 style="text-align: center">=</h4>
                       </div>
                       <div class="col-lg-2 pull-right input-group" style="padding: 0">
                           <div class="input-group-addon">$</div>
                           <input style="width: 100px" class="form-control text-center" ng-value="main.travelNumberOfStaffUsingBikesTotal()" disabled="disabled"/>
                       </div>
                   </div>
                   <hr>
                   <div class="row">
                       {{ travel_items_formset.management_form }}
                       {% for item_form in travel_items_formset %}
                           <div id='{{item_form.prefix}}'>
                               {% include "budget/other_item_cost.html" with form=item_form %}
                           </div>
                       {% endfor %}
                       <script type="text/javascript">
                           /* Allows for the creation of more or less staff/committee members */
                               $(function() {
                                   {% for formset in travel_items_formset %}
                                   $('div#{{ formset.prefix }}').formset({
                                      prefix: '{{ formset.prefix }}',
                                      formCssClass: 'travel-formset{{ forloop.counter }}',
                                      addText: '+ Add Another Item',
                                      deleteText: 'Remove Item',
                                      addCssClass: 'add-travel btn btn-success changeaddbtn col-lg-offset-4',
                                      deleteCssClass: 'delete-travel repositionremovebtn btn btn-danger',
                                   });
                                   {% endfor %}
                               })
                       </script>
                   </div>


                   <div class="row center" style="margin-top: 20px; padding-right: 200px; padding-left: 200px; text-align: center">
                       <label>Total Travel</label>
                       <input style="width: 100px" class="form-control text-center" ng-value="main.travelTotal()" disabled="disabled"/>
                   </div>

               </div>
               <!-- End Travel -->

                <!-- Supplies -->
               <div class="col-md-6">
                   <h2 class="background"><span>Supplies</span></h2>
                   <div class="row">
                       <div class="col-lg-4 col-lg-offset-2">
                           <input class="form-control" type="checkbox" id="supplies_walkie_talkies_bool" ng-model="main.form.supplies_walkie_talkies_boolean"/>
                       </div>
                       <div class="col-lg-4">
                           <input class="form-control" type="number" id="supplies_walkie_talkies_amount" ng-model="main.form.supplies_walkie_talkies_amount"/>
                       </div>
                   </div>
                   <div class="row">
                       <div class="col-lg-4 col-lg-offset-2">
                           <input class="form-control" type="checkbox" id="supplies_recorders_bool" ng-model="main.form.supplies_recorders_boolean"/>
                       </div>
                       <div class="col-lg-4">
                           <input class="form-control" type="number" id="supplies_recorders_amount" ng-model="main.form.supplies_recorders_amount"/>
                       </div>
                   </div>
                   <div class="row">
                       <div class="col-lg-4 col-lg-offset-2">
                           <input class="form-control" type="checkbox" id="supplies_binoculars_bool" ng-model="main.form.supplies_binoculars_boolean"/>
                       </div>
                       <div class="col-lg-4">
                           <input class="form-control" type="number" id="supplies_binoculars_amount" ng-model="main.form.supplies_binoculars_amount"/>
                       </div>
                   </div>
                   <div class="row">
                       <div class="col-lg-4 col-lg-offset-2">
                           <input class="form-control" type="checkbox" id="supplies_flashlights_bool" ng-model="main.form.supplies_flashlights_boolean"/>
                       </div>
                       <div class="col-lg-4">
                           <input class="form-control" type="number" id="supplies_flashlights_amount" ng-model="main.form.supplies_flashlights_amount"/>
                       </div>
                   </div>
                   <hr>
                   <div class="row">
                       {{ supplies_items_formset.management_form }}
                       {% for item_form in supplies_items_formset %}
                           <div id='{{item_form.prefix}}'>
                               {% include "budget/other_item_cost.html" with form=item_form %}
                           </div>
                       {% endfor %}
                       <script type="text/javascript">
                           /* Allows for the creation of more or less staff/committee members */
                               $(function() {
                                   {% for formset in supplies_items_formset %}
                                   $('div#{{ formset.prefix }}').formset({
                                      prefix: '{{ formset.prefix }}',
                                      formCssClass: 'supplies-formset{{ forloop.counter }}',
                                      addText: '+ Add Another Item',
                                      deleteText: 'Remove Item',
                                      addCssClass: 'add-supplies btn btn-success changeaddbtn col-lg-offset-4',
                                      deleteCssClass: 'delete-supplies repositionremovebtn btn btn-danger',
                                   });
                                   {% endfor %}
                               })
                       </script>
                   </div>

                   <div class="row center" style="margin-top: 20px; padding-right: 200px; padding-left: 200px; text-align: center">
                       <label>Total Supplies</label>
                       <input style="width: 100px" class="form-control text-center" ng-value="main.suppliesTotal()" disabled="disabled"/>
                   </div>
               </div>
           </div>
           <!-- End Supplies -->

            <!-- Administration -->
           <div class="row">
               <div class="col-md-6">
                   <h2 class="background"><span>Administration</span></h2>
                   <div class="row">
                       <div class="col-md-2 input-with-text calc-form-input-no-width">
                           <input class="form-control" type="number" id="admin_number_of_interceptions_last_month" ng-model="main.form.administration_number_of_intercepts_last_month"/>
                           <small># of intercepts last month</small>
                       </div>
                       <div class="col-md-1 form-symbol">
                           <h4 style="text-align: center">*</h4>
                       </div>
                       <div class="col-md-2 calc-form-input-no-width">
                           <input class="form-control" type="number" id="admin_number_of_interceptions_last_month_multiplier" ng-model="main.form.administration_number_of_intercepts_last_month_multiplier"/>
                       </div>
                       <div class="col-md-1 form-symbol">
                           <h4 style="text-align: center">+</h4>
                       </div>
                       <div class="col-md-2 calc-form-input-no-width">
                           <input class="form-control" type="number" id="admin_number_of_interceptions_last_month_adder" ng-model="main.form.administration_number_of_intercepts_last_month_adder"/>
                       </div>
                       <div class="col-md-1 form-symbol">
                           <h4 style="text-align: center">=</h4>
                       </div>
                       <div class="col-lg-2 pull-right input-group" style="width: 150px; padding: 0">
                           <div class="input-group-addon">$</div>
                           <input style="width: 100px" class="form-control text-center" ng-value="main.adminStationaryTotal()" disabled="disabled"/>
                       </div>
                   </div>
                   <div class="row row-padding" >
                       <div class="col-md-2 input-with-text calc-form-input-no-width">
                           <input class="form-control" type="number" id="admin_number_of_meetings_per_month" ng-model="main.form.administration_number_of_meetings_per_month"/>
                           <small># of meetings per month</small>
                       </div>
                       <div class="col-md-1 form-symbol">
                           <h4 style="text-align: center">*</h4>
                       </div>
                       <div class="col-md-2 calc-form-input-no-width">
                           <input class="form-control" type="number" id="admin_number_of_meetings_per_month_multiplier" ng-model="main.form.administration_number_of_meetings_per_month_multiplier"/>
                       </div>
                       <div class="col-md-1 form-symbol">
                           <h4 style="text-align: center">=</h4>
                       </div>
                       <div class="col-lg-2 pull-right input-group" style="width: 150px; padding: 0">
                           <div class="input-group-addon">$</div>
                           <input style="width: 100px" class="form-control text-center" ng-value="main.adminMeetingsTotal()" disabled="disabled"/>
                       </div>
                   </div>
                   <div class="row row-padding">
                       <div class="col-lg-2" style="margin-top: 7px; width: 50px">
                           <small><input class="form-control" type="checkbox" id="admin_booth_bool" ng-model="main.form.administration_booth"/></small>
                       </div>
                       <div class="col-lg-2 input-with-text" style="width: 100px; padding: 0">
                           <input class="form-control" type="number" id="admin_booth_amount" ng-model="main.form.administration_booth_amount"/>
                           <small>Booth</small>
                       </div>
                       <div class="col-lg-2" style="margin-top: 7px; width: 50px">
                           <input class="form-control" type="checkbox" id="admin_registration_bool" ng-model="main.form.administration_registration"/>
                       </div>
                       <div class="col-lg-2 input-with-text" style="width: 100px; padding: 0">
                           <input class="form-control" type="number" id="admin_registration_amount" ng-model="main.form.administration_registration_amount"/>
                           <small>Registration</small>
                       </div>
                       <div class="col-md-1 form-symbol">
                           <h4 style="text-align: center">=</h4>
                       </div>
                       <div class="col-lg-2 pull-right input-group" style="width: 150px; padding: 0">
                           <div class="input-group-addon">$</div>
                           <input style="width: 100px" class="form-control text-center" ng-value="main.adminBoothRentalTotal()" disabled="disabled"/>
                       </div>
                   </div>
                   <div class="row center" style="margin-top: 20px; padding-right: 200px; padding-left: 200px; text-align: center">
                       <label>Total Admininstration</label>
                       <input style="width: 100px" class="form-control text-center" ng-value="main.adminTotal()" disabled="disabled"/>
                   </div>
               </div>
               <!-- End Administration -->

               <!-- Total Table -->
               <div class="col-md-6">
                   <table class="table table-bordered table-hover">
                        <thead>
                            <tr>
                                <th colspan="3" class="text-center">Border Monitoring Station</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Salaries</td>
                                <td width="25%"></td>
                                <td class="active" width="25%"></td>
                            </tr>
                            <tr>
                                <td>Comm.</td>
                                <td><p ng-bind="main.commTotal()"></p></td>
                                <td class="active"></td>
                            </tr> bind
                            <tr>
                                <td>Travel</td>
                                <td><p ng-bind="main.travelTotal()"></p></td>
                                <td class="active"></td>
                            </tr>
                            <tr>
                                <td>Admin.</td>
                                <td><p ng-bind="main.adminTotal()"></p></td>
                                <td class="active"></td>
                            </tr>
                            <tr>
                                <td>Medical</td>
                                <td><p ng-bind="main.medicalTotal()"></p></td>
                                <td class="active"></td>
                            </tr>
                            <tr>
                                <td>Misc.</td>
                                <td><p ng-bind="main.miscTotal()"></p></td>
                                <td class="active"></td>
                            </tr>
                            <tr>
                                <td class="text-right"><b>TOTAL</b></td>
                                <td colspan="2"><p ng-bind="main.bunchTotal()"></p></td>
                            </tr>
                        </tbody>
                        <thead>
                            <tr class="warning">
                                <th colspan="3" class="text-center">Safe Houses</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="warning">Shelter</td>
                                <td class="warning"><p ng-bind="main.shelterTotal()"></p></td>
                                <td class="active"></td>
                            </tr>
                            <tr>
                                <td class="warning">Food</td>
                                <td class="warning"><p ng-bind="main.foodTotal()"></p></td>
                                <td class="active"></td>
                            </tr>
                            <tr class="warning">
                                <td class="text-right"><b>TOTAL</b></td>
                                <td colspan="2"><p ng-bind="main.foodAndShelterTotal()"></p></td>
                            </tr>
                        </tbody>
                        <tbody>
                            <tr>
                                <td class="text-center"><b>Awareness</b></td>
                                <td colspan="2"><p ng-bind="main.awarenessTotal()"></p></td>
                            </tr>
                            <tr>
                                <td class="text-center"><b>Supplies</b></td>
                                <td colspan="2"><p ng-bind="main.suppliesTotal()"></p></td>
                            </tr>
                            <tr>
                                <td class="text-center"><b>STATION TOTAL</b></td>
                                <td colspan="2"><p ng-bind="main.stationTotal()"></p></td>
                            </tr>
                            <tr>
                                <td class="text-center">Last month's TOTAL</td>
                                <td colspan="2"></td>
                            </tr>
                        </tbody>

                    </table>
                </div>
            </div>
            <!-- End Table -->

            <!-- Medical -->
            <div class="row">
                <div class="col-md-6">
                    <h2 class="background"><span>Medical</span></h2>
                    <div class="row form-inline">
                        <div class="col-md-5 pull-left input-with-text" style="width: 270px">
                            <input class="form-control" type="number" id="medical_expense" ng-model="main.form.medical_last_months_expense"/>
                            <small>Last month's medical expense</small>
                        </div>
                        <div class="col-md-1 form-symbol">
                            <h4 style="text-align: center">=</h4>
                        </div>
                        <div class="col-md-6" style="width: 260px">
                            <input style="width: 100px" class="form-control text-center pull-right" ng-value="main.medicalTotal()" disabled="disabled"/>
                        </div>
                    </div>
                </div>
            </div>
            <!-- End Medical -->

            <!-- Miscellaneous -->
           <div class="row">
               <div class="col-md-6">
                   <h2 class="background"><span>Miscellaneous</span></h2>
                   <div class="row">
                       <div class="col-lg-2 input-with-text calc-form-input-no-width">
                           <input class="form-control" type="number" id="misc_number_of_intercepts" ng-model="main.form.miscellaneous_number_of_intercepts_last_month"/>
                           <small># of intercepts last month</small>
                       </div>
                       <div class="col-lg-1 form-symbol">
                           <h4 style="text-align: center">*</h4>
                       </div>
                       <div class="col-lg-2 calc-form-input-no-width">
                           <input class="form-control" type="number" id="misc_number_of_intercepts_mult" ng-model="main.form.miscellaneous_number_of_intercepts_last_month_multiplier"/>
                       </div>
                       <div class="col-lg-1 form-symbol">
                           <h4 style="text-align: center">=</h4>
                       </div>
                       <div class="col-lg-2 pull-right input-group" style="padding: 0">
                           <div class="input-group-addon">$</div>
                           <input style="width: 100px" class="form-control text-center" ng-value="main.miscMaximum()" disabled="disabled"/>
                       </div>
                   </div>

                   <hr>
                   <div class="row">
                       {{ misc_items_formset.management_form }}
                       {% for item_form in misc_items_formset %}
                           <div id='{{item_form.prefix}}'>
                               {% include "budget/other_item_cost.html" with form=item_form %}
                           </div>
                       {% endfor %}
                       <script type="text/javascript">
                           /* Allows for the creation of more or less staff/committee members */
                               $(function() {
                                   {% for formset in misc_items_formset %}
                                   $('div#{{ formset.prefix }}').formset({
                                      prefix: '{{ formset.prefix }}',
                                      formCssClass: 'misc-formset{{ forloop.counter }}',
                                      addText: '+ Add Another Item',
                                      deleteText: 'Remove Item',
                                      addCssClass: 'add-misc btn btn-success changeaddbtn col-lg-offset-4',
                                      deleteCssClass: 'delete-misc repositionremovebtn btn btn-danger',
                                   });
                                   {% endfor %}
                               })
                       </script>
                   </div>

                   <div class="row center" style="margin-top: 20px; padding-right: 200px; padding-left: 200px; text-align: center">
                       <label>Total Miscellaneous</label>
                       <input style="width: 100px" class="formxt-center" ng-value="main.miscTotal()" disabled="disabled"/>
                   </div>
               </div>
           </div>
           <!-- End Miscellaneous -->

            <input type="submit" ng-show="main.update" class="pull-right btn btn-success navbar-btn btn-lg" value = "Submit" ng-click="main.saveForm()"/>
            <input type="submit" ng-show="main.create" id="budget_create" class="pull-right btn btn-primary navbar-btn btn-lg" value = "Submit" ng-click="main.createForm()" />
        </div>

     {% if submit_type %}
        <div class="row">
            <!--<input type="submit" class="pull-right btn btn-primary navbar-btn btn-lg" value="{{ submit_type }}" />-->
        </div>
     {% endif %}
     </form>

<script>
angular.module('BudgetCalculation', ['ngCookies'])
        .config(['$httpProvider', function($httpProvider) {
            $httpProvider.defaults.xsrfCookieName = 'csrftoken';
            $httpProvider.defaults.xsrfHeaderName = 'X-CSRFToken';
        }])
        .controller('MainCtrl', ['$scope','$http','$locationProvider', function($scope, $http) {

            var vm = this;

            vm.form = {};

            vm.retrieveForm = function(id) {
                console.log({{ budget_calc.pk }});
                $http.get('/budget/api/budget_calculations/' + id + '/').
                        success(function (data) {
                            //We can reference the json object to fill our vm variables
                            vm.form = data;
                            console.log(vm.form);
                        }).
                        error(function (data, status, headers, config) {
                            // called asynchronously if an error occurs
                            // or server returns response with an error status.
                        });
            };


            vm.foodAndShelterTotal = function() {
                return vm.foodTotal() + vm.shelterTotal();
            };
            vm.bunchTotal = function() {
                return vm.commTotal() + vm.travelTotal() + vm.adminTotal() +
                        vm.medicalTotal();
            };
            vm.stationTotal = function() {
                return vm.foodAndShelterTotal() + vm.bunchTotal() +
                        vm.awarenessTotal() + vm.suppliesTotal();
            };

            //shelter

            vm.utilTotal = function() {
                return (vm.form.shelter_rent + vm.form.shelter_water + vm.form.shelter_electricity);
            };

            vm.shelterCheckboxTotal = function() {
                var totalAmount = 0;
                if (vm.form.shelter_shelter_startup) {
                    totalAmount += vm.form.shelter_shelter_startup_amount;
                }
                if (vm.form.shelter_shelter_two) {
                    totalAmount += vm.form.shelter_shelter_two_amount;
                }
                return totalAmount;
            };
            vm.shelterTotal = function () {
                return vm.form.shelter_rent + vm.form.shelter_water + vm.form.shelter_electricity + vm.shelterCheckboxTotal();
            };

            //Food and Gas Section

            vm.foodGasInterceptedGirls = function () {
                return vm.form.food_and_gas_number_of_intercepted_girls_multiplier_before * vm.form.food_and_gas_number_of_intercepted_girls * vm.form.food_and_gas_number_of_intercepted_girls_multiplier_after;
            };
            vm.foodGasLimboGirls = function () {
                return vm.form.food_and_gas_limbo_girls_multiplier * vm.form.food_and_gas_number_of_limbo_girls * vm.form.food_and_gas_number_of_days;
            };
            vm.foodTotal = function () {
                return vm.foodGasInterceptedGirls() + vm.foodGasLimboGirls();
            };

            //Communication Section
            vm.commManagerTotal = function () {
                var amount = 0;

                if (vm.form.communication_chair) {
                    amount += vm.form.communication_chair_amount;
                }
                if (vm.form.communication_manager) {
                    amount += vm.form.communication_manager_amount;
                }
                return amount;
            };

            vm.commNumberOfStaffTotal = function () {
                return vm.form.communication_number_of_staff_with_walkie_talkies * vm.form.communication_number_of_staff_with_walkie_talkies_multiplier;
            };

            vm.commEachStaffTotal = function () {
                return vm.form.communication_each_staff * vm.form.communication_each_staff_multiplier;
            };

            vm.commTotal = function () {
                return vm.commManagerTotal() + vm.commNumberOfStaffTotal() + vm.commEachStaffTotal();
            };

            //Misc Section
            vm.miscMaximum = function() {
                return vm.form.miscellaneous_number_of_intercepts_last_month * vm.form.miscellaneous_number_of_intercepts_last_month_multiplier;
            };
            vm.miscTotal = function() {
                return vm.miscMaximum();
            };

            //Medical Section
            vm.medicalTotal = function() {
                return vm.form.medical_last_months_expense;
            };

            //Administration Section
            vm.adminStationaryTotal = function() {
                return (vm.form.administration_number_of_intercepts_last_month * vm.form.administration_number_of_intercepts_last_month_multiplier) + vm.form.administration_number_of_intercepts_last_month_adder;
            };
            vm.adminMeetingsTotal = function() {
                return vm.form.administration_number_of_meetings_per_month * vm.form.administration_number_of_meetings_per_month_multiplier;
            };
            vm.adminBoothRentalTotal = function() {
                var amount = 0;
                if(vm.form.administration_booth) {
                    amount += vm.form.administration_booth_amount;
                }
                if(vm.form.administration_registration) {
                    amount += vm.form.administration_registration_amount;
                }
                return amount;
            };
            vm.adminTotal = function() {
                return vm.adminStationaryTotal() + vm.adminMeetingsTotal() + vm.adminBoothRentalTotal();
            };

            //Travel Section
            vm.travelNumberOfStaffUsingBikesTotal = function() {
                return vm.form.travel_number_of_staff_using_bikes * vm.form.travel_number_of_staff_using_bikes_multiplier;
            };
            vm.travelTotal = function() {
                var amount = 0;
                if(vm.form.travel_chair_with_bike) {
                    amount += vm.form.travel_chair_with_bike_amount;
                }
                if(vm.form.travel_manager_with_bike) {
                    amount += vm.form.travel_manager_with_bike_amount;
                }
                if(vm.form.travel_motorbike) {
                    amount += vm.form.travel_motorbike_amount;
                }
                return amount + vm.form.travel_plus_other + vm.form.travel_last_months_expense_for_sending_girls_home + (vm.form.travel_number_of_staff_using_bikes * vm.form.travel_number_of_staff_using_bikes_multiplier);
            };

            //Supplies Section
            vm.suppliesTotal = function() {
                var amount = 0;
                if(vm.form.supplies_walkie_talkies_boolean) {
                    amount += vm.form.supplies_walkie_talkies_amount;
                }
                if(vm.form.supplies_recorders_boolean) {
                    amount += vm.form.supplies_recorders_amount;
                }
                if(vm.form.supplies_binoculars_boolean) {
                    amount += vm.form.supplies_binoculars_amount;
                }
                if(vm.form.supplies_flashlights_boolean) {
                    amount += vm.form.supplies_flashlights_amount;
                }
                return amount;
            };

            //Awareness Section
            vm.awarenessTotal = function() {
                var amount = 0;
                if(vm.form.awareness_contact_cards) {
                    amount += vm.form.awareness_contact_cards_amount;
                }
                if(vm.form.awareness_awareness_party_boolean) {
                    amount += vm.form.awareness_awareness_party;
                }
                if(vm.form.awareness_sign_boards_boolean) {
                    amount += vm.form.awareness_sign_boards;
                }
                return amount;
            };

            vm.deletePost = function(id) {
                $http.delete('/budget/api/budget_calculations/' + id + '/').
                        success(function (data, status, headers, config) {
                            console.log("1");
                        }).
                        error(function (data, status, headers, config) {
                            console.log("2");
                            // called asynchronously if an error occurs
                            // or server returns response with an error status.
                        })
            };

            vm.updateForm = function() {
                //console.log(browser.url);
                console.log(vm.form);
                $http.put('/budget/api/budget_calculations/' + vm.form.id + '/', vm.form)
                    .success(function(data, status) {
                        console.log(data);
                    })
                    .error(function(data, status) {
                        console.log(data);
                    });
            //console.log(result);
            };

            vm.createForm = function() {
                $http.post('/budget/api/budget_calculations/', vm.form)
                    .success(function(data, status) {
                        console.log(data);
                    })
                    .error(function(data, status) {
                        console.log(data);
                    });


            };


            if( ({{ submit_type }}) == 1 ) {
                vm.create = true;
                vm.form.border_station = ({{ pk }});

            }
            else if( ({{ submit_type }}) == 2)  {
                vm.update = true;
                vm.retrieveForm({{ pk }});
            }
            else {
                vm.retrieveForm({{ pk }});
            }

        }]);
</script>

    {% endblock %}
{% endblock %}