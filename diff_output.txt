diff --git a/application/casedispatcher/libraries/entity_model.py b/application/casedispatcher/libraries/entity_model.py
index e8a551b2..527d57c2 100644
--- a/application/casedispatcher/libraries/entity_model.py
+++ b/application/casedispatcher/libraries/entity_model.py
@@ -126,37 +126,50 @@ class EntityGroup(GetAttr):
     def move_closed(cls, soc_df):
         """Moves closed cases to closed sheet for each Entity Group instance."""
         for sheet in cls.sheets:
+            # Handle previously closed cases
             prev_closed = sheet.newcopy[
                 sheet.newcopy[sheet.uid].isin(soc_df[soc_df.arrested == 1].suspect_id)
             ].copy()
             prev_closed["case_status"] = prev_closed["case_status"].fillna("").astype(str)
-
             prev_closed.loc[:, "case_status"] = "Closed: Already in Legal Cases Sheet"

-            # Update newly_closed to be data where "Case_Status" contains "Closed"
+            # Handle newly closed cases
             newly_closed = sheet.gsheet[sheet.gsheet["case_status"].str.contains("Closed", na=False)]

-            # Populate the 'date' column with today's date
+            # Add timestamps
             today = pd.Timestamp.today().normalize()
             newly_closed['date'] = today
-
-            today = pd.Timestamp.today().normalize()
             newly_closed['supervisor_review'] = today

+            # Remove duplicates from prev_closed
             prev_closed = prev_closed[
                 ~prev_closed[sheet.uid].isin(sheet.closed[sheet.uid])
             ]

-            original_cols = list(prev_closed.columns)
-            new_cols = [original_cols[i] + str(i) for i in range(len(original_cols))]
+            # Get unique columns from sheet.closed
+            target_columns = pd.Index(sheet.closed.columns).drop_duplicates()

-            sheet.closed.columns = new_cols
-            prev_closed.columns = new_cols
-            newly_closed.columns = new_cols
+            # Create temporary copies with unique column names
+            sheet_closed_unique = sheet.closed.loc[:, target_columns]
+            prev_closed_unique = prev_closed.loc[:, prev_closed.columns.drop_duplicates()]
+            newly_closed_unique = newly_closed.loc[:, newly_closed.columns.drop_duplicates()]

-            sheet.closed = pd.concat([sheet.closed, prev_closed, newly_closed])
-            sheet.closed.columns = original_cols
+            # Ensure all DataFrames have the same columns
+            common_columns = list(set(target_columns) &
+                                  set(prev_closed_unique.columns) &
+                                  set(newly_closed_unique.columns))
+
+            # Filter to common columns before concatenation
+            sheet.closed = pd.concat([
+                sheet_closed_unique[common_columns],
+                prev_closed_unique[common_columns],
+                newly_closed_unique[common_columns]
+            ])
+
+            # Remove duplicates
             sheet.closed.drop_duplicates(subset=sheet.uid, inplace=True)
+
+            # Remove closed cases from active
             sheet.active = sheet.active[
                 ~sheet.active[sheet.uid].isin(sheet.closed[sheet.uid])
             ]
diff --git a/application/lji_social_media/libraries/claude_prompts.py b/application/lji_social_media/libraries/claude_prompts.py
index 1520fccd..f0edf420 100644
--- a/application/lji_social_media/libraries/claude_prompts.py
+++ b/application/lji_social_media/libraries/claude_prompts.py
@@ -13,102 +13,123 @@ ANALYSIS_STR = """' Return your analysis STRICTLY and exclusively in the followi
 EXTRACTION_PROMPTS = {
     "phone_number_prompt": "Extract phone numbers from the following text and return your findings as a list:"
 }
-
-
 CLAUDE_PROMPTS = {
-    "assure_prompt": (
-        "Examine the following job advertisement. "
-        "Does the job ad convey a tone or use language that subtly assures applicants they are highly likely to get the job, even if it doesn't explicitly say so? "
-        "Look for phrases or a manner of presenting the opportunity that implies it's a 'sure thing' or guarantees success. "
-    ),
-    "bypass_prompt": (
-        "Analyze the following job advertisement for any mentions of offers to bypass normal job requirements. "
-        "This may include using fraudulent documents, skipping interviews, or not needing a CV. "
-    ),
-    "callback_request_prompt": (
-        "Examine the following job advertisement. Does it ask the candidate to send a message and promise to call back? "
-    ),
-    "drop_off_at_secure_location_prompt": (
-        "Analyze the following job advertisement in detail. Are applicants "
-        "asked to drop off their CVs at a real, secure and official location? "
-    ),
-    "false_organization_prompt": (
-        "Examine the following job advertisement. Does it recruit for an organization that has publicly stated they don't advertise job posts on social media? "
-        " Some of these companies include, but are not limited to, [Shoprite, Woolworths, Capitec Bank, Pick n Pay, Spar, Coca-Cola, Transnet, Sasol]"
-    ),
-    "gender_specific_prompt": (
-        " Examine the following job advertisement."
-        " Does it recruit specifically only females or only males for a job that both male and female applicants would typically qualify for? "
-    ),
-    "illegal_activities_prompt": (
-        "Analyze the following job advertisement for any references to work in illegal or morally questionable activities. "
-    ),
-    "immediate_hiring_prompt": (
-        "Examine the following job advertisement. Does it promise immediate hiring? "
-    ),
-    "job_advert_prompt": (
-        "Analyze the following text carefully. "
-        "Can this be considered a job or recruitment advertisement? "
-    ),
-    "language_switch_prompt": (
-        "Examine the following job advertisement. Does it change from English to other languages in the middle of the post? "
-    ),
-    "link_prompt": (
-        "Analyze the following text. Is there one or more links or urls mentioned? When asked tp do so, extract the ONLY the link(s) as evidence. "
-    ),
-    "multiple_provinces_prompt": (
-        "Analyze the following job advertisement. Does it advertise for positions in several provinces, especially without detail? "
-    ),
-    "no_education_skilled_prompt": (
-        "Analyze the following job advertisement. Does it offer a highly skilled job (e.g., engineering, marketing, finance, IT) "
-        "without requiring any education or experience? "
-    ),
-    "no_location_prompt": (
-        "Examine the following job advertisement. Does it fail to mention a specific job location? "
-    ),
-    "overseas_prompt": (
-        "Examine the following job advertisement. Does it offer positions overseas (i.e. outside of South Africa)? "
-    ),
-    "phone_prompt": (
-        "Analyze the following text. Is there one or more phone numbers mentioned? When asked to do so, extract ONLY the numbers(s) as evidence. "
-    ),
-    "quick_money_prompt": (
-        "Analyze the following job advertisement. Does it promise quick or easy money? "
-    ),
-    "recruit_students_prompt": (
-        "Analyze the following job advertisement. Does it specifically recruit people who are under the age of 18? "
-    ),
-    "recruitment_prompt": (
-        "Analyze the following text. Is it unambiguously a recruitment advert? "
-    ),
-    "requires_references": (
-        "Examine the following job advertisement. Does it require the applicant to provide references?"
-    ),
-    "suspicious_email_prompt": (
-        "Analyze the following job advertisement. Please clearly and precisely differentiate between "
-        "email addresses and links.  If an email IS present, does it appear suspicious in the context of the job advertisement? "
-    ),
-    "target_specific_group_prompt": (
-        "Analyze the following job advertisement. Does it target a specific group of people (e.g., women from a particular country or region)? "
-        "Consider vulnerable groups to include these, but not exclusively,[Shona,Ndebele,Basotho, Tswana', Zulu, Mozambicans, Chewa, Yao]"
-    ),
-    "unprofessional_writing_prompt": (
-        "Analyze the following job advertisement for signs of unprofessional writing such as poor grammar or spelling. "
-        "Accept that missing spaces or words not separated by a space or spaces in the text, such as 'andcleaners', 'towork', is NOT a sign of unprofessional writing. "
-    ),
-    "unrealistic_hiring_number_prompt": (
-        "Analyze the following job advertisement. Does it claim to be hiring an unrealistically high number of people? "
-    ),
-    "unusual_hours_prompt": (
-        "Examine the following job advertisement. Does it mention unusual or excessive work hours? "
-    ),
-    "vague_description_prompt": (
-        "Examine the job advertisement and assess whether the description is unusually vague or lacks essential details that would typically be expected for the role. "
-        "Consider if the level of detail provided is insufficient or unclear, particularly for specialized or technical positions where more specific "
-        "responsibilities are normally outlined. "
-    ),
+    "callback_request_prompt": "Examine the following job advertisement. Does it ask the candidate to send a message and promise to call back?",
+    "dance_bar_prompt": "Analyze the following job advertisement. Does it offer a job position in a dance bar or gentlemen's club?",
+    "drop_off_at_secure_location_prompt": "Analyze the following job advertisement in detail. Are applicants asked to drop off their CVs at a real and official location in person-, i.e. a physical location?",
+    "false_organization_prompt": "Examine the following job advertisement. Does it recruit for an organization that has publicly stated they don't advertise job posts on social media? Some of these companies include, but are not limited to, [Shoprite, Woolworths, Capitec Bank, Pick n Pay, Spar, Coca-Cola, Transnet, Sasol]",
+    "gender_specific_prompt": "Review the following job advertisement. Does it specifically seek only male or only female applicants for a job that is not inherently gender-specific? Exclude scenarios where specifying gender is reasonable, such as caregiving roles requiring a same-gender caregiver for personal care.",
+    "language_switch_prompt": "Examine the following job advertisement. Does it change from English to other languages in the middle of the post?",
+    "massage_or_spa_prompt": "Analyze the following job advertisement. Does it offer a job in a massage parlour, spa or similar institution?",
+    "multiple_provinces_prompt": "Analyze the following job advertisement. Does it advertise for positions in several provinces, especially without detail?",
+    "no_education_skilled_prompt": "Analyze the following job advertisement. Does it offer a highly skilled job (e.g., engineering, marketing, finance, IT) without requiring any education or experience?",
+    "no_location_prompt": "Examine the following job advertisement. Does it fail to mention a specific job location?",
+    "overseas_position_prompt": "Examine the following job advertisement. Does it offer positions overseas (i.e. outside of South Africa)?",
+    "recruit_minors_prompt": "Analyze the following job advertisement. Does it specifically recruit people who are under the age of 18?",
+    "soccer_trial_prompt": "Analyze the following job advertisement. Does it offer soccer or other sports trial opportunities for applicants?",
+    "suspicious_assurance_prompt": "Analyze the job advertisement for unusual or suspicious assurance that the person will be hired more easily or surely than would be typical.",
+    "suspicious_email_prompt": "Analyze the following job advertisement. Does it contain an email address that appears suspicious in the context of the job advertisement? Make sure to differentiate between email addresses and links and make your assessment only based on email addresses and not links.",
+    "target_specific_group_prompt": "Analyze the following job advertisement. Does it target a specific group of people (e.g., women from a particular country or region)? Consider vulnerable groups to include these, but not exclusively, [Shona,Ndebele,Basotho, Tswana', Zulu, Mozambicans, Chewa, Yao]",
+    "unprofessional_writing_prompt": "Analyze the following job advertisement for signs of unprofessional writing such as poor grammar or spelling. Accept that missing spaces or words not separated by a space or spaces in the text, such as 'andcleaners', 'towork', is NOT a sign of unprofessional writing.",
+    "unrealistic_hiring_number_prompt": "Analyze the following job advertisement. Does it claim to be hiring an unrealistically high number of people?",
 }

+#
+#
+# CLAUDE_PROMPTS = {
+#     "assure_prompt": (
+#         "Examine the following job advertisement. "
+#         "Does the job ad convey a tone or use language that subtly assures applicants they are highly likely to get the job, even if it doesn't explicitly say so? "
+#         "Look for phrases or a manner of presenting the opportunity that implies it's a 'sure thing' or guarantees success. "
+#     ),
+#     "bypass_prompt": (
+#         "Analyze the following job advertisement for any mentions of offers to bypass normal job requirements. "
+#         "This may include using fraudulent documents, skipping interviews, or not needing a CV. "
+#     ),
+#     "callback_request_prompt": (
+#         "Examine the following job advertisement. Does it ask the candidate to send a message and promise to call back? "
+#     ),
+#     "drop_off_at_secure_location_prompt": (
+#         "Analyze the following job advertisement in detail. Are applicants "
+#         "asked to drop off their CVs at a real, secure and official location? "
+#     ),
+#     "false_organization_prompt": (
+#         "Examine the following job advertisement. Does it recruit for an organization that has publicly stated they don't advertise job posts on social media? "
+#         " Some of these companies include, but are not limited to, [Shoprite, Woolworths, Capitec Bank, Pick n Pay, Spar, Coca-Cola, Transnet, Sasol]"
+#     ),
+#     "gender_specific_prompt": (
+#         " Examine the following job advertisement."
+#         " Does it recruit specifically only females or only males for a job that both male and female applicants would typically qualify for? "
+#     ),
+#     "illegal_activities_prompt": (
+#         "Analyze the following job advertisement for any references to work in illegal or morally questionable activities. "
+#     ),
+#     "immediate_hiring_prompt": (
+#         "Examine the following job advertisement. Does it promise immediate hiring? "
+#     ),
+#     "job_advert_prompt": (
+#         "Analyze the following text carefully. "
+#         "Can this be considered a job or recruitment advertisement? "
+#     ),
+#     "language_switch_prompt": (
+#         "Examine the following job advertisement. Does it change from English to other languages in the middle of the post? "
+#     ),
+#     "link_prompt": (
+#         "Analyze the following text. Is there one or more links or urls mentioned? When asked tp do so, extract the ONLY the link(s) as evidence. "
+#     ),
+#     "multiple_provinces_prompt": (
+#         "Analyze the following job advertisement. Does it advertise for positions in several provinces, especially without detail? "
+#     ),
+#     "no_education_skilled_prompt": (
+#         "Analyze the following job advertisement. Does it offer a highly skilled job (e.g., engineering, marketing, finance, IT) "
+#         "without requiring any education or experience? "
+#     ),
+#     "no_location_prompt": (
+#         "Examine the following job advertisement. Does it fail to mention a specific job location? "
+#     ),
+#     "overseas_prompt": (
+#         "Examine the following job advertisement. Does it offer positions overseas (i.e. outside of South Africa)? "
+#     ),
+#     "phone_prompt": (
+#         "Analyze the following text. Is there one or more phone numbers mentioned? When asked to do so, extract ONLY the numbers(s) as evidence. "
+#     ),
+#     "quick_money_prompt": (
+#         "Analyze the following job advertisement. Does it promise quick or easy money? "
+#     ),
+#     "recruit_students_prompt": (
+#         "Analyze the following job advertisement. Does it specifically recruit people who are under the age of 18? "
+#     ),
+#     "recruitment_prompt": (
+#         "Analyze the following text. Is it unambiguously a recruitment advert? "
+#     ),
+#     "requires_references": (
+#         "Examine the following job advertisement. Does it require the applicant to provide references?"
+#     ),
+#     "suspicious_email_prompt": (
+#         "Analyze the following job advertisement. Please clearly and precisely differentiate between "
+#         "email addresses and links.  If an email IS present, does it appear suspicious in the context of the job advertisement? "
+#     ),
+#     "target_specific_group_prompt": (
+#         "Analyze the following job advertisement. Does it target a specific group of people (e.g., women from a particular country or region)? "
+#         "Consider vulnerable groups to include these, but not exclusively,[Shona,Ndebele,Basotho, Tswana', Zulu, Mozambicans, Chewa, Yao]"
+#     ),
+#     "unprofessional_writing_prompt": (
+#         "Analyze the following job advertisement for signs of unprofessional writing such as poor grammar or spelling. "
+#         "Accept that missing spaces or words not separated by a space or spaces in the text, such as 'andcleaners', 'towork', is NOT a sign of unprofessional writing. "
+#     ),
+#     "unrealistic_hiring_number_prompt": (
+#         "Analyze the following job advertisement. Does it claim to be hiring an unrealistically high number of people? "
+#     ),
+#     "unusual_hours_prompt": (
+#         "Examine the following job advertisement. Does it mention unusual or excessive work hours? "
+#     ),
+#     "vague_description_prompt": (
+#         "Examine the job advertisement and assess whether the description is unusually vague or lacks essential details that would typically be expected for the role. "
+#         "Consider if the level of detail provided is insufficient or unclear, particularly for specialized or technical positions where more specific "
+#         "responsibilities are normally outlined. "
+#     ),
+# }
+
 prompts = [
     "suspicious_email_prompt",
     "recruit_students_prompt",
@@ -117,26 +138,47 @@ prompts = [
     "assure_prompt",
 ]

+# RED_FLAGS = [
+#     "assure_prompt",
+#     "bypass_prompt",
+#     "callback_request_prompt",
+#     "drop_off_at_secure_location_prompt",
+#     "false_organization_prompt",
+#     "gender_specific_prompt",
+#     "immediate_hiring_prompt",
+#     "language_switch_prompt",
+#     "multiple_provinces_prompt",
+#     "no_education_skilled_prompt",
+#     "no_location_prompt",
+#     "overseas_prompt",
+#     "quick_money_prompt",
+#     "recruit_students_prompt",
+#     "requires_references",
+#     "suspicious_email_prompt",
+#     "target_specific_group_prompt",
+#     "unprofessional_writing_prompt",
+#     "unrealistic_hiring_number_prompt",
+#     "unusual_hours_prompt",
+#     "vague_description_prompt",
+# ]
 RED_FLAGS = [
-    "assure_prompt",
-    "bypass_prompt",
     "callback_request_prompt",
+    "dance_bar_prompt",
     "drop_off_at_secure_location_prompt",
     "false_organization_prompt",
     "gender_specific_prompt",
-    "immediate_hiring_prompt",
     "language_switch_prompt",
+    "massage_or_spa_prompt",
     "multiple_provinces_prompt",
     "no_education_skilled_prompt",
     "no_location_prompt",
-    "overseas_prompt",
-    "quick_money_prompt",
-    "recruit_students_prompt",
-    "requires_references",
+    "overseas_position_prompt",
+    "recruit_minors_prompt",
+    "sense_of_urgency_prompt",
+    "soccer_trial_prompt",
+    "suspicious_assurance_prompt",
     "suspicious_email_prompt",
     "target_specific_group_prompt",
     "unprofessional_writing_prompt",
     "unrealistic_hiring_number_prompt",
-    "unusual_hours_prompt",
-    "vague_description_prompt",
 ]
diff --git a/application/lji_social_media/redflags/redflag_maintenance_asyncio.py b/application/lji_social_media/redflags/redflag_maintenance_asyncio.py
index 63f1296b..61c18d2e 100644
--- a/application/lji_social_media/redflags/redflag_maintenance_asyncio.py
+++ b/application/lji_social_media/redflags/redflag_maintenance_asyncio.py
@@ -143,7 +143,7 @@ async def process_advert_async(IDn: int, prompt_name: str) -> None:

         # 3. Do the analysis - this can stay async
         response = await loop.run_in_executor(
-            None, lf.analyse_advert, chat_engine, advert, prompt_name
+            None, lf.analyse_advert, chat_engine, prompt_name
         )
         if response.result == "error":
             logger.error(f"Analysis failed for IDn {IDn}: {response.explanation}")
@@ -174,7 +174,7 @@ async def process_batch_async(adverts: pd.DataFrame, prompt_name: str) -> None:

 def query_adverts(prompt_name: str) -> pd.DataFrame:
     query = """
-    MATCH (g:Group)-[:HAS_POSTING]-(n:Posting)
+    MATCH (g:Group)-[:HAS_POSTING]-(n:RecruitmentAdvert)
     WHERE g.country_id = 1
       AND n.text IS NOT NULL
       AND n.text <> ""
@@ -190,7 +190,7 @@ def query_adverts(prompt_name: str) -> pd.DataFrame:


 async def main_async():
-    prompt_names = cp.RED_FLAGS
+    # prompt_names = cp.RED_FLAGS
     prompt_names = cp.CLAUDE_PROMPTS.keys()

     for prompt_name in prompt_names:
diff --git a/application/lji_social_media/redflags/redflag_ml_deeplearning.py b/application/lji_social_media/redflags/redflag_ml_deeplearning.py
index a2103609..c2462a6e 100644
--- a/application/lji_social_media/redflags/redflag_ml_deeplearning.py
+++ b/application/lji_social_media/redflags/redflag_ml_deeplearning.py
@@ -546,7 +546,7 @@ def main():
         raise ValueError("Original data must contain 'IDn' column")

     # Load the same splits as ensemble model
-    splits_timestamp = "20241114_115648"
+    splits_timestamp = "20241204_122617"
     splits, split_info = load_splits(splits_timestamp)

     # Generate unique model identifier
diff --git a/application/lji_social_media/redflags/simplified_redflag_model.py b/application/lji_social_media/redflags/simplified_redflag_model.py
index 156b075d..e7295993 100644
--- a/application/lji_social_media/redflags/simplified_redflag_model.py
+++ b/application/lji_social_media/redflags/simplified_redflag_model.py
@@ -455,7 +455,7 @@ def main():
     Main function with corrected ID handling.
     """
     # Load original data with proper ID handling
-    file_path = "../results/advert_flags.csv"
+    file_path = "results/advert_flags.csv"
     print("Loading original data...")
     original_data = pd.read_csv(file_path)

@@ -464,7 +464,7 @@ def main():
         raise ValueError("Original data must contain 'IDn' column")

     # Load splits
-    splits_timestamp = "20241114_115648"
+    splits_timestamp = "20241204_122617"
     splits, split_info = load_splits(splits_timestamp)

     # Generate unique model identifier
diff --git a/application/lji_social_media/streamlit_fb_friends.py b/application/lji_social_media/streamlit_fb_friends.py
index 92ac350e..770eeb4d 100644
--- a/application/lji_social_media/streamlit_fb_friends.py
+++ b/application/lji_social_media/streamlit_fb_friends.py
@@ -3,7 +3,7 @@ from oauth2client.service_account import ServiceAccountCredentials
 import pandas as pd
 from gspread_dataframe import set_with_dataframe
 import gspread
-
+import libraries.neo4j_lib as nl
 from selenium.webdriver.common.action_chains import ActionChains
 from selenium.webdriver.remote.webdriver import WebDriver
 from selenium.webdriver.common.by import By
@@ -18,21 +18,10 @@ import subprocess
 from random import randint
 import re
 from bs4 import BeautifulSoup
-from py2neo import Graph
-from datetime import datetime
-from selenium.common.exceptions import NoSuchElementException, TimeoutException
-

-# Environment variable fetching and error handling
-neo4j_url = os.environ.get("NEO4J_URL")
-neo4j_usr = os.environ.get("NEO4J_USR", "neo4j")  # Default to 'neo4j' if not set
-neo4j_pwd = os.environ.get("NEO4J_PWD")

-if not all([neo4j_url, neo4j_usr, neo4j_pwd]):
-    raise EnvironmentError("Required NEO4J environment variables are not set.")
-
-# Initialize Graph
-graph = Graph(neo4j_url, user=neo4j_usr, password=neo4j_pwd)
+from datetime import datetime
+from selenium.common.exceptions import NoSuchElementException, TimeoutException


 from social_media.social_media import (
@@ -446,8 +435,7 @@ CALL apoc.create.addLabels(p, CASE WHEN NOT 'SourceProfile' IN labels(p) THEN ['
 CALL apoc.create.addLabels(f, CASE WHEN $follower_url = $source_url AND NOT 'FollowerProfile' IN labels(f) THEN ['FollowerProfile'] ELSE [] END) YIELD node as fNode
 RETURN pNode, fNode
 """
-
-        graph.run(query, parameters).data()
+        nl.execute_neo4j_query(query, parameters)
         profile_dicts.append(parameters)
     pd.DataFrame(profile_dicts).to_csv(
         "results/follower_profile_dicts.csv", index=False
@@ -490,7 +478,7 @@ CALL apoc.create.addLabels(f, CASE WHEN $friend_url = $source_url AND NOT 'Frien
 RETURN pNode, fNode
 """

-        graph.run(query, parameters).data()
+        nl.execute_neo4j_query(query, parameters)
         profile_dicts.append(parameters)
     pd.DataFrame(profile_dicts).to_csv("results/profile_dicts.csv", index=False)
     logging.info("Successfully created results/profile_dicts.csv")
