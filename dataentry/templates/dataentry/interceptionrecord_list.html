{% extends "dataentry/dataentry_base.html" %}
{% load bootstrap %}
{% load times %}

{% block title %}All IRFs{% endblock %}

{% block body_class %}interceptionrecord_list{% endblock %}


{% block content %}
{% if request.user.permission_irf_view %}
    <p class="pull-right" style="margin-top: 30px"><a class="btn btn-primary" href="{% url 'interceptionrecord_csv_export' %}">Export as CSV</a></p>
{% endif %}

{% if request.user.permission_irf_view %}
    <h1>All IRFs</h1>
    {% if interceptionrecord_list %}
    <table class="table table-striped table-condensed">
        <thead>
            <tr>
                <th>IRF #</th>
                <th>Staff Name</th>
                <th># of victims</th>
                <th># of traffickers</th>
                <th>Date/Time<br/>of Interception</th>
                <th>Date/Time<br/>Entered Into System</th>
                <th>Date/Time<br/>Last Edited</th>
                <th>&nbsp;</th>
            </tr>
        </thead>
        <tbody>
            {% for irf in interceptionrecord_list %}
            <tr>
                <td class="irf-number">{{ irf.irf_number }}</td>
                <td>{{ irf.staff_name }}</td>
                <td>{{ irf.number_of_victims }}</td>
                <td>{{ irf.number_of_traffickers }}</td>
                <td>{{ irf.date_time_of_interception }}</td>
                <td>{{ irf.date_time_entered_into_system }}</td>
                <td>{{ irf.date_time_last_updated }}</td>
                <td>
                    <a class="btn btn-sm btn-primary" href="{% url 'interceptionrecord_detail' irf.pk %}">View</a>
                    {% if request.user.permission_irf_edit %}
                        <a class="btn btn-sm btn-primary" href="{% url 'interceptionrecord_update' irf.pk %}">Edit</a>
                    {% endif %}
                    {% if request.user.is_superuser %}
                        {% include "delete_modal_forms.html" with form=irf url_string="interceptionrecord_delete"%}
                        <button class="btn btn-sm btn-danger" data-toggle="modal" data-target="#modal-{{ irf.pk }}">Delete</button>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody> 
    </table>
    {% else %}
        {% if database_empty %}
            <p>There are not yet any IRFs in the database. </p>
        {% else %}
            <p>There are no matching IRFs you are looking for</p>
        {% endif %}
    {% endif %}
{% else %}
    <h1>IRFs</h1>
{% endif %}


<div id="footer">
    <nav class="navbar navbar-default navbar-fixed-bottom">
        <div class="container">
            {% if request.user.permission_irf_add %}
                <div class="navbar-inner navbar-content-center">
                    <a class="pull-right btn btn-success navbar-btn" href="{% url 'interceptionrecord_create' %}">Input A New IRF</a>
                </div>
            {% endif %}

            <ul class="pagination pull-left" style="margin: 10px !important">
                {% if page_obj.has_previous %}
                    <li><a href="?page={{ page_obj.previous_page_number }}">&laquo;</a></li>
                {% else %}
                    <li class="disabled"><a href="">&laquo;</a></li>
                {% endif %}

                {% for i in page_obj.paginator.num_pages|times %}
                <li{% if page_obj.number == i|add:"1" %} class="active"{% endif %}>
                    <a href="?page={{ i|add:"1" }}">{{ i|add:"1" }}</a>
                </li>
                {% endfor %}

                {% if page_obj.has_next %} 
                    <li><a href="?page={{ page_obj.next_page_number }}">&raquo;</a></li>
                {% else %}
                    <li class="disabled"><a href="">&raquo;</a></li>
                {% endif %}
                
            </ul>
        </div>
    </nav>
</div>
{% endblock %}
